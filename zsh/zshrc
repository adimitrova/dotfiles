#
# Executes commands at the start of an interactive session.
#
# Authors:
#   Sorin Ionescu <sorin.ionescu@gmail.com>
#

# Source Prezto.
if [[ -s "${ZDOTDIR:-$HOME}/.zprezto/init.zsh" ]]; then
  source "${ZDOTDIR:-$HOME}/.zprezto/init.zsh"
fi

# Command line keymappings
# bindkey -M viins 'kj' vi-cmd-mode

# Movement
# bindkey -M viins '^[' vi-cmd-mode
bindkey -M viins '^a' beginning-of-line
bindkey -M viins '^b' vi-backward-word-end
bindkey -M viins '^e' end-of-line
bindkey -M viins '^f' vi-forward-word

# Editing
bindkey -M viins '^@' list-choices
bindkey -M viins '^k' kill-line
bindkey -M viins '^u' backward-kill-line
bindkey -M viins '^w' backward-kill-word

# History
bindkey -M isearch '^M' accept-search
bindkey -M isearch '^n' history-incremental-search-forward
bindkey -M isearch '^p' history-incremental-search-backward
bindkey -M viins '^n' down-history
bindkey -M viins '^p' up-history
bindkey -M viins '^r' history-incremental-search-backward

# Adjust fpath to load custom functions
fpath=($HOME/.zfunc $HOME/.zcomp $fpath)
autoload -Uz $HOME/.zfunc/*(:t); autoload -Uz $HOME/.zcomp/*(:t)
autoload -U compinit; compinit

# Load zmv
autoload -U zmv

# Source nvm
[ -s $HOME/.nvm/nvm.sh ] && source $HOME/.nvm/nvm.sh && nvm use stable > /dev/null 2>&1

# Load aliases
[ -f $HOME/.alias ] && source $HOME/.alias

# Init rbenv
if command -v rbenv > /dev/null 2>&1; then
    eval "$(rbenv init -)"
fi
